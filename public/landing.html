<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guerrero Guardianes - Predicci√≥n Gubernatura 2027</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1e3a8a',
                        secondary: '#059669',
                        accent: '#d97706',
                        gold: '#fbbf24'
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse-glow {
            0%, 100% {
                box-shadow: 0 0 20px rgba(251, 191, 36, 0.5);
            }
            50% {
                box-shadow: 0 0 40px rgba(251, 191, 36, 0.8);
            }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .fade-in-up {
            animation: fadeInUp 0.8s ease-out forwards;
        }

        .pulse-glow {
            animation: pulse-glow 2s ease-in-out infinite;
        }

        .candidate-card {
            transition: all 0.3s ease;
        }

        .candidate-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }

        .candidate-card.selected {
            border: 3px solid #fbbf24;
            box-shadow: 0 0 30px rgba(251, 191, 36, 0.4);
        }

        .progress-bar {
            transition: width 1s ease-out;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 via-white to-emerald-50">

    <!-- HERO SECTION -->
    <section class="relative min-h-screen flex items-center justify-center overflow-hidden bg-gradient-to-br from-blue-900 via-blue-800 to-emerald-900">
        <div class="absolute inset-0 opacity-10">
            <div class="absolute inset-0" style="background-image: url('data:image/svg+xml,%3Csvg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"%3E%3Cg fill="none" fill-rule="evenodd"%3E%3Cg fill="%23ffffff" fill-opacity="1"%3E%3Cpath d="M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E');"></div>
        </div>

        <div class="relative z-10 container mx-auto px-6 text-center">
            <div class="fade-in-up">
                <div class="inline-block mb-6">
                    <span class="text-6xl">üõ°Ô∏è</span>
                </div>

                <h1 class="text-5xl md:text-7xl font-bold text-white mb-6 leading-tight">
                    Guerrero <span class="text-gold">Guardianes</span>
                </h1>

                <p class="text-xl md:text-2xl text-blue-100 mb-4 max-w-3xl mx-auto">
                    Ciudadanos de Guerrero predicen juntos, con datos reales,
                    de forma an√≥nima y segura
                </p>

                <p class="text-lg text-blue-200 mb-12 max-w-2xl mx-auto">
                    üó≥Ô∏è Valida las elecciones de junio 2027 con el poder de la inteligencia colectiva
                </p>

                <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
                    <a href="#encuesta" class="pulse-glow bg-gold hover:bg-yellow-500 text-blue-900 font-bold text-lg px-10 py-5 rounded-full transition-all duration-300 shadow-2xl">
                        üöÄ Participar en la Predicci√≥n Piloto
                    </a>

                    <a href="#como-funciona" class="bg-white/10 hover:bg-white/20 text-white font-semibold px-8 py-5 rounded-full backdrop-blur-sm border-2 border-white/30 transition-all duration-300">
                        üìñ C√≥mo Funciona
                    </a>
                </div>

                <div class="mt-16 grid grid-cols-3 gap-8 max-w-3xl mx-auto">
                    <div class="text-center">
                        <div class="text-4xl font-bold text-gold mb-2" id="live-participants">0</div>
                        <div class="text-sm text-blue-200">Guerrerenses participando</div>
                    </div>
                    <div class="text-center">
                        <div class="text-4xl font-bold text-gold mb-2">100%</div>
                        <div class="text-sm text-blue-200">An√≥nimo y Seguro</div>
                    </div>
                    <div class="text-center">
                        <div class="text-4xl font-bold text-gold mb-2">2027</div>
                        <div class="text-sm text-blue-200">Validaci√≥n Electoral</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="absolute bottom-8 left-1/2 transform -translate-x-1/2 animate-bounce">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
            </svg>
        </div>
    </section>

    <!-- C√ìMO FUNCIONA -->
    <section id="como-funciona" class="py-20 bg-white">
        <div class="container mx-auto px-6">
            <div class="text-center mb-16">
                <h2 class="text-4xl md:text-5xl font-bold text-blue-900 mb-4">
                    ¬øC√≥mo Funciona?
                </h2>
                <p class="text-xl text-gray-600 max-w-2xl mx-auto">
                    Participa en 4 pasos simples y ayuda a construir el mapa predictivo m√°s grande de Guerrero
                </p>
            </div>

            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8 max-w-6xl mx-auto">
                <div class="text-center group">
                    <div class="bg-gradient-to-br from-blue-500 to-blue-700 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6 text-white text-3xl font-bold shadow-xl group-hover:scale-110 transition-transform duration-300">
                        1
                    </div>
                    <h3 class="text-xl font-bold text-blue-900 mb-3">Elige tu Candidato(a)</h3>
                    <p class="text-gray-600">
                        Selecciona al perfil que crees que ganar√° o que prefieres para 2027
                    </p>
                </div>

                <div class="text-center group">
                    <div class="bg-gradient-to-br from-emerald-500 to-emerald-700 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6 text-white text-3xl font-bold shadow-xl group-hover:scale-110 transition-transform duration-300">
                        2
                    </div>
                    <h3 class="text-xl font-bold text-blue-900 mb-3">Mide tu Confianza</h3>
                    <p class="text-gray-600">
                        Usa el "Slider de Seguridad" para indicar qu√© tan seguro est√°s
                    </p>
                </div>

                <div class="text-center group">
                    <div class="bg-gradient-to-br from-amber-500 to-amber-700 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6 text-white text-3xl font-bold shadow-xl group-hover:scale-110 transition-transform duration-300">
                        3
                    </div>
                    <h3 class="text-xl font-bold text-blue-900 mb-3">Env√≠o An√≥nimo</h3>
                    <p class="text-gray-600">
                        Tu voto se procesa con encriptaci√≥n sin registros ni contrase√±as
                    </p>
                </div>

                <div class="text-center group">
                    <div class="bg-gradient-to-br from-purple-500 to-purple-700 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6 text-white text-3xl font-bold shadow-xl group-hover:scale-110 transition-transform duration-300">
                        4
                    </div>
                    <h3 class="text-xl font-bold text-blue-900 mb-3">Poder Ciudadano</h3>
                    <p class="text-gray-600">
                        Visualiza estad√≠sticas en tiempo real comparadas con miles de guerrerenses
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- M√ìDULO DE ENCUESTA -->
    <section id="encuesta" class="py-20 bg-gradient-to-br from-blue-50 to-emerald-50">
        <div class="container mx-auto px-6 max-w-7xl">
            <div class="text-center mb-12">
                <h2 class="text-4xl md:text-5xl font-bold text-blue-900 mb-4">
                    üó≥Ô∏è Predicci√≥n Gubernatura 2027
                </h2>
                <p class="text-xl text-gray-600 mb-2">
                    ¬øQui√©n crees que ganar√° la gubernatura de Guerrero?
                </p>
                <p class="text-sm text-gray-500">
                    ‚ö° Sin registro ¬∑ 100% an√≥nimo ¬∑ Resultados en tiempo real
                </p>
            </div>

            <!-- ENCUESTAS ACTIVAS DIN√ÅMICAS -->
            <div id="surveys-container" class="grid gap-6 mb-12">
                <div class="text-center py-12">
                    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-900 mx-auto mb-4"></div>
                    <p class="text-gray-600">Cargando encuestas activas...</p>
                </div>
            </div>

            <!-- CONTENEDOR PARA PREGUNTAS DIN√ÅMICAS -->
            <div id="questions-container" class="hidden">
                <!-- Las preguntas se renderizar√°n aqu√≠ din√°micamente -->
            </div>
        </div>
    </section>

    <!-- RESULTADOS EN VIVO -->
    <section id="results" class="py-20 bg-white">
        <div class="container mx-auto px-6 max-w-5xl">
            <div class="text-center mb-12">
                <h2 class="text-4xl md:text-5xl font-bold text-blue-900 mb-4">
                    üìä Resultados en Tiempo Real
                </h2>
                <p class="text-xl text-gray-600">
                    Predicciones de <span class="font-bold text-gold" id="total-votes">0</span> guerrerenses
                </p>
            </div>

            <div id="results-container" class="space-y-4">
                <!-- Los resultados se llenar√°n din√°micamente -->
            </div>
        </div>
    </section>

    <!-- FAQ -->
    <section id="faq" class="py-20 bg-gradient-to-br from-blue-900 to-emerald-900 text-white">
        <div class="container mx-auto px-6 max-w-4xl">
            <div class="text-center mb-12">
                <h2 class="text-4xl md:text-5xl font-bold mb-4">
                    Preguntas Frecuentes
                </h2>
                <p class="text-xl text-blue-200">
                    Todo lo que necesitas saber sobre Guerrero Guardianes
                </p>
            </div>

            <div class="space-y-4">
                <div class="bg-white/10 backdrop-blur-sm rounded-xl overflow-hidden">
                    <button onclick="toggleFAQ(1)" class="w-full text-left p-6 flex justify-between items-center hover:bg-white/20 transition-all">
                        <span class="font-bold text-lg">üîí ¬øC√≥mo protegemos tu anonimato?</span>
                        <svg class="w-6 h-6 transition-transform" id="faq-icon-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </button>
                    <div id="faq-content-1" class="hidden px-6 pb-6">
                        <p class="text-blue-100">
                            <strong>No guardamos IP ni datos personales.</strong> Tu voto se procesa mediante encriptaci√≥n de extremo a extremo. No hay registros, no hay contrase√±as, no hay forma de rastrear tu identidad.
                        </p>
                    </div>
                </div>

                <div class="bg-white/10 backdrop-blur-sm rounded-xl overflow-hidden">
                    <button onclick="toggleFAQ(2)" class="w-full text-left p-6 flex justify-between items-center hover:bg-white/20 transition-all">
                        <span class="font-bold text-lg">üß™ ¬øPor qu√© es una prueba piloto?</span>
                        <svg class="w-6 h-6 transition-transform" id="faq-icon-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </button>
                    <div id="faq-content-2" class="hidden px-6 pb-6">
                        <p class="text-blue-100">
                            Esta encuesta piloto permite validar la tecnolog√≠a de "Guardianes del Voto" antes de junio 2027.
                        </p>
                    </div>
                </div>

                <div class="bg-white/10 backdrop-blur-sm rounded-xl overflow-hidden">
                    <button onclick="toggleFAQ(3)" class="w-full text-left p-6 flex justify-between items-center hover:bg-white/20 transition-all">
                        <span class="font-bold text-lg">üìà ¬øQu√© tan confiables son los resultados?</span>
                        <svg class="w-6 h-6 transition-transform" id="faq-icon-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </button>
                    <div id="faq-content-3" class="hidden px-6 pb-6">
                        <p class="text-blue-100">
                            Mientras m√°s participen, m√°s preciso ser√° el mapa predictivo. Tu voto cuenta.
                        </p>
                    </div>
                </div>

                <div class="bg-white/10 backdrop-blur-sm rounded-xl overflow-hidden">
                    <button onclick="toggleFAQ(4)" class="w-full text-left p-6 flex justify-between items-center hover:bg-white/20 transition-all">
                        <span class="font-bold text-lg">üéØ ¬øPuedo cambiar mi predicci√≥n?</span>
                        <svg class="w-6 h-6 transition-transform" id="faq-icon-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </button>
                    <div id="faq-content-4" class="hidden px-6 pb-6">
                        <p class="text-blue-100">
                            En esta fase piloto, cada dispositivo puede emitir una predicci√≥n por sesi√≥n.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA FINAL -->
    <section class="py-20 bg-gradient-to-r from-gold to-yellow-500">
        <div class="container mx-auto px-6 text-center">
            <h2 class="text-4xl md:text-5xl font-bold text-blue-900 mb-6">
                ¬øListo para hacer historia?
            </h2>
            <p class="text-xl text-blue-800 mb-8 max-w-2xl mx-auto">
                √önete a miles de guerrerenses construyendo el mapa predictivo m√°s grande de M√©xico
            </p>
            <a href="#encuesta" class="inline-block bg-blue-900 hover:bg-blue-800 text-white font-bold text-lg px-12 py-5 rounded-full transition-all duration-300 shadow-2xl hover:scale-105">
                üó≥Ô∏è Participar Ahora
            </a>
        </div>
    </section>

    <!-- FOOTER -->
    <footer class="bg-blue-900 text-white py-12">
        <div class="container mx-auto px-6">
            <div class="text-center">
                <div class="text-4xl mb-4">üõ°Ô∏è</div>
                <h3 class="text-2xl font-bold mb-4">Guerrero Guardianes</h3>
                <p class="text-blue-200 mb-6">
                    Validando la democracia con el poder ciudadano
                </p>
                <div class="flex justify-center space-x-6 mb-6">
                    <a href="#" class="text-blue-200 hover:text-white transition-colors">Privacidad</a>
                    <a href="#" class="text-blue-200 hover:text-white transition-colors">T√©rminos</a>
                    <a href="#faq" class="text-blue-200 hover:text-white transition-colors">FAQ</a>
                    <a href="./" class="text-blue-200 hover:text-white transition-colors">Portal Ciudadano</a>
                </div>
                <p class="text-sm text-blue-300">
                    ¬© 2026 Guerrero Guardianes ¬∑ Proyecto piloto tecnol√≥gico ¬∑ Guerrero, M√©xico
                </p>
            </div>
        </div>
    </footer>

    <!-- JAVASCRIPT FUNCIONAL -->
    <script>
        // ========================================
        // CONFIGURACI√ìN GLOBAL
        // ========================================
        // Configuraci√≥n din√°mica para desarrollo y producci√≥n
        const API_URL = window.location.hostname === 'localhost'
            ? 'http://localhost:3000'
            : `${window.location.protocol}//${window.location.host}`;

        // Estado global
        let activeSurveyId = null;
        let surveyQuestions = [];
        let votes = {};

        console.log('üöÄ [LANDING] Iniciando aplicaci√≥n...');
        console.log('üîó [LANDING] API URL:', API_URL);

        // ========================================
        // CARGAR ENCUESTAS ACTIVAS
        // ========================================
        async function loadActiveSurveys() {
            try {
                console.log('üì° [LANDING] Solicitando encuestas activas...');

                const response = await fetch(`${API_URL}/api/surveys/active`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();
                console.log('‚úÖ [LANDING] Respuesta recibida:', data);
                console.log('üìä [LANDING] Encuestas encontradas:', data.surveys?.length || 0);

                const container = document.getElementById('surveys-container');

                if (!data.surveys || data.surveys.length === 0) {
                    container.innerHTML = `
                        <div class="text-center py-12 bg-yellow-50 rounded-lg border-2 border-yellow-200">
                            <div class="text-5xl mb-4">üìã</div>
                            <p class="text-yellow-800 text-lg font-semibold mb-2">
                                Encuesta Piloto en preparaci√≥n
                            </p>
                            <p class="text-yellow-600">
                                Regresa en breve para participar en la predicci√≥n
                            </p>
                        </div>
                    `;
                    return;
                }

                // Guardar ID de la primera encuesta activa
                activeSurveyId = data.surveys[0].id;
                console.log('‚úÖ [LANDING] Encuesta activa ID:', activeSurveyId);

                // Cargar preguntas de la encuesta
                await loadSurveyQuestions(activeSurveyId);

                // Renderizar encuestas
                container.innerHTML = data.surveys.map((survey) => `
                    <div class="bg-white rounded-xl p-6 shadow-lg border-l-4 border-green-500 relative hover:shadow-2xl transition-shadow duration-300">
                        <div class="absolute top-4 right-4 flex items-center gap-2">
                            <span class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></span>
                            <span class="text-xs font-bold text-green-600 uppercase tracking-wide">EN VIVO</span>
                        </div>

                        <h3 class="text-2xl font-bold text-blue-900 mb-2 pr-20">
                            ${survey.title || 'Encuesta'}
                        </h3>

                        <p class="text-gray-600 mb-4">${survey.description || ''}</p>

                        <div class="flex gap-3 flex-wrap">
                            <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-semibold">
                                üó≥Ô∏è ${survey.electionType || 'Encuesta'}
                            </span>
                            <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-semibold">
                                ‚úî Activa
                            </span>
                            <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-semibold">
                                üë• ${survey.totalRespondents || 0} participantes
                            </span>
                        </div>
                    </div>
                `).join('');

            } catch (error) {
                console.error('‚ùå [LANDING] Error cargando encuestas:', error.message);
                const container = document.getElementById('surveys-container');
                container.innerHTML = `
                    <div class="text-center py-12 bg-red-50 rounded-lg border-2 border-red-200">
                        <div class="text-5xl mb-4">‚ö†Ô∏è</div>
                        <p class="text-red-600 font-semibold mb-2">Error al cargar encuestas</p>
                        <p class="text-red-500 text-sm">${error.message}</p>
                        <button onclick="loadActiveSurveys()" class="mt-4 bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-lg transition-colors">
                            üîÑ Reintentar
                        </button>
                    </div>
                `;
            }
        }

        // ========================================
        // CARGAR PREGUNTAS DE LA ENCUESTA
        // ========================================
        async function loadSurveyQuestions(surveyId) {
            try {
                console.log('üì° [LANDING] Cargando preguntas de encuesta ID:', surveyId);

                const response = await fetch(`${API_URL}/api/surveys/${surveyId}/questions`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }

                const data = await response.json();
                surveyQuestions = data.questions || [];

                console.log('‚úÖ [LANDING] Preguntas cargadas:', surveyQuestions.length);
                if (surveyQuestions.length > 0) {
                    console.log('üìã [LANDING] Primera pregunta:', {
                        id: surveyQuestions[0].id,
                        texto: surveyQuestions[0].questionText || surveyQuestions[0].question_text,
                        tipo: surveyQuestions[0].questionType || surveyQuestions[0].question_type,
                        opciones: surveyQuestions[0].options
                    });

                    // Renderizar preguntas din√°micamente
                    renderSurveyQuestions();
                }

            } catch (error) {
                console.error('‚ùå [LANDING] Error cargando preguntas:', error.message);
                surveyQuestions = [];
            }
        }

        // ========================================
        // RENDERIZAR PREGUNTAS DIN√ÅMICAMENTE
        // ========================================
        function renderSurveyQuestions() {
            const container = document.getElementById('questions-container');

            if (surveyQuestions.length === 0) {
                container.classList.add('hidden');
                return;
            }

            container.classList.remove('hidden');

            let html = '<div class="space-y-8">';

            surveyQuestions.forEach((question, index) => {
                const qText = question.questionText || question.question_text;
                const qType = question.questionType || question.question_type;
                const qOptions = question.options || {};
                const qRequired = question.isRequired !== false;

                html += `
                    <div class="bg-white rounded-2xl shadow-2xl p-8">
                        <h3 class="text-2xl font-bold text-blue-900 mb-6">
                            ${index + 1}. ${qText}
                        </h3>
                `;

                if (qType === 'confidence_scale' || qType === 'scale') {
                    // Slider de confianza
                    html += `
                        <div class="mb-8">
                            <input type="range" id="confidence-slider" min="${qOptions.min || 0}" max="${qOptions.max || 100}" step="${qOptions.step || 1}" value="75"
                                   class="w-full h-3 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-gold"
                                   oninput="updateConfidence(this.value)">
                            <div class="flex justify-between mt-4 text-sm font-semibold">
                                <span class="text-gray-500">${qOptions.min || 0}${qOptions.unit || '%'}</span>
                                <span class="text-blue-600">75${qOptions.unit || '%'}</span>
                                <span class="text-emerald-600">${qOptions.max || 100}${qOptions.unit || '%'}</span>
                            </div>
                        </div>
                        <div class="text-center mb-6">
                            <div class="text-5xl font-bold text-gold mb-2" id="confidence-display">75${qOptions.unit || '%'}</div>
                            <div class="text-gray-600" id="confidence-label">Probable</div>
                        </div>
                    `;
                } else if (qType === 'single_choice' || qType === 'multiple_choice') {
                    // Opciones de candidatos
                    html += `
                        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                            <div class="candidate-card bg-white rounded-xl p-6 shadow-lg cursor-pointer border-2 border-transparent" onclick="selectCandidate('felix-salgado', 'MORENA')">
                                <div class="text-center mb-4">
                                    <div class="w-16 h-16 bg-gradient-to-br from-red-500 to-red-700 rounded-full mx-auto mb-4 flex items-center justify-center text-white text-2xl font-bold">
                                        FS
                                    </div>
                                    <h4 class="font-bold text-lg text-gray-800">F√©lix Salgado Macedonio</h4>
                                    <p class="text-sm text-gray-500">Senador</p>
                                </div>
                            </div>
                            <div class="candidate-card bg-white rounded-xl p-6 shadow-lg cursor-pointer border-2 border-transparent" onclick="selectCandidate('beatriz-mojica', 'MORENA')">
                                <div class="text-center mb-4">
                                    <div class="w-16 h-16 bg-gradient-to-br from-red-500 to-red-700 rounded-full mx-auto mb-4 flex items-center justify-center text-white text-2xl font-bold">
                                        BM
                                    </div>
                                    <h4 class="font-bold text-lg text-gray-800">Beatriz Mojica Morga</h4>
                                    <p class="text-sm text-gray-500">Alcaldesa Acapulco</p>
                                </div>
                            </div>
                            <div class="candidate-card bg-white rounded-xl p-6 shadow-lg cursor-pointer border-2 border-transparent" onclick="selectCandidate('manuel-anorve', 'PRI')">
                                <div class="text-center mb-4">
                                    <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full mx-auto mb-4 flex items-center justify-center text-white text-2xl font-bold">
                                        MA
                                    </div>
                                    <h4 class="font-bold text-lg text-gray-800">Manuel A√±orve Ba√±os</h4>
                                    <p class="text-sm text-gray-500">PRI ¬∑ Senador</p>
                                </div>
                            </div>
                            <div class="candidate-card bg-white rounded-xl p-6 shadow-lg cursor-pointer border-2 border-transparent" onclick="selectCandidate('abelina-lopez', 'MORENA')">
                                <div class="text-center mb-4">
                                    <div class="w-16 h-16 bg-gradient-to-br from-red-500 to-red-700 rounded-full mx-auto mb-4 flex items-center justify-center text-white text-2xl font-bold">
                                        AL
                                    </div>
                                    <h4 class="font-bold text-lg text-gray-800">Abelina L√≥pez Rodr√≠guez</h4>
                                    <p class="text-sm text-gray-500">Gobernadora</p>
                                </div>
                            </div>
                            <div class="candidate-card bg-white rounded-xl p-6 shadow-lg cursor-pointer border-2 border-transparent" onclick="selectCandidate('karen-castrejon', 'PVEM')">
                                <div class="text-center mb-4">
                                    <div class="w-16 h-16 bg-gradient-to-br from-green-500 to-green-600 rounded-full mx-auto mb-4 flex items-center justify-center text-white text-2xl font-bold">
                                        KC
                                    </div>
                                    <h4 class="font-bold text-lg text-gray-800">Karen Castrej√≥n Trujillo</h4>
                                    <p class="text-sm text-gray-500">PVEM ¬∑ Diputada</p>
                                </div>
                            </div>
                            <div class="candidate-card bg-white rounded-xl p-6 shadow-lg cursor-pointer border-2 border-transparent" onclick="selectCandidate('pedro-segura', 'IND')">
                                <div class="text-center mb-4">
                                    <div class="w-16 h-16 bg-gradient-to-br from-purple-500 to-purple-600 rounded-full mx-auto mb-4 flex items-center justify-center text-white text-2xl font-bold">
                                        PS
                                    </div>
                                    <h4 class="font-bold text-lg text-gray-800">Pedro Segura Valladares</h4>
                                    <p class="text-sm text-gray-500">Candidato Independiente</p>
                                </div>
                            </div>
                        </div>
                    `;
                }

                html += '</div>';
            });

            html += `
                <div id="confidence-section" class="hidden">
                    <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-2xl mx-auto">
                        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-6">
                            <p class="text-sm text-gray-700">
                                <strong>Seleccionaste:</strong> <span id="selected-candidate-name"></span>
                            </p>
                        </div>
                        <button onclick="submitPrediction()" class="w-full bg-gold hover:bg-yellow-500 text-blue-900 font-bold text-lg py-4 rounded-xl shadow-lg transition-all duration-300 hover:scale-105">
                            ‚úÖ Enviar Mi Predicci√≥n
                        </button>
                    </div>
                </div>
            `;

            html += '</div>';

            container.innerHTML = html;
        }

        // ========================================
        // FUNCIONES DE INTERACCI√ìN
        // ========================================
        let selectedCandidate = null;
        let selectedParty = null;
        let confidence = 75;

        function selectCandidate(candidateId, party) {
            console.log('üëÜ [LANDING] Candidato seleccionado:', candidateId, party);

            // Remover selecci√≥n anterior
            document.querySelectorAll('.candidate-card').forEach(card => {
                card.classList.remove('selected');
            });

            // Agregar selecci√≥n actual
            event.currentTarget.classList.add('selected');
            selectedCandidate = candidateId;
            selectedParty = party;

            // Mostrar nombre del candidato
            const candidateName = event.currentTarget.querySelector('h4').textContent;
            document.getElementById('selected-candidate-name').textContent = candidateName;

            // Mostrar secci√≥n de confianza si hay slider
            const confidenceSection = document.getElementById('confidence-section');
            if (confidenceSection) {
                confidenceSection.classList.remove('hidden');
                confidenceSection.scrollIntoView({
                    behavior: 'smooth',
                    block: 'center'
                });
            }
        }

        function updateConfidence(value) {
            confidence = parseInt(value);
            document.getElementById('confidence-display').textContent = confidence + '%';

            let label = 'Dudoso';
            let color = 'text-gray-600';

            if (confidence === 75) {
                label = 'Probable';
                color = 'text-blue-600';
            } else if (confidence === 100) {
                label = 'Seguro';
                color = 'text-emerald-600';
            }

            const labelElement = document.getElementById('confidence-label');
            labelElement.textContent = label;
            labelElement.className = color;

            console.log('üìä [LANDING] Confianza actualizada:', confidence + '%', label);
        }

        async function submitPrediction() {
            console.log('üéØ [LANDING] submitPrediction() iniciado');

            if (!selectedCandidate) {
                alert('‚ö†Ô∏è Por favor selecciona un candidato primero');
                return;
            }

            if (!activeSurveyId) {
                alert('‚ö†Ô∏è No hay encuesta activa disponible');
                return;
            }

            // Deshabilitar bot√≥n mientras se procesa
            const submitButton = event.target;
            const originalText = submitButton.innerHTML;
            submitButton.disabled = true;
            submitButton.innerHTML = '‚è≥ Enviando...';

            // Construir payload din√°mico
            const responses = surveyQuestions.map(question => {
                const qId = question.id;
                const qType = question.questionType || question.question_type;

                let answer;
                let questionConfidence = null;

                if (qType === 'confidence_scale' || qType === 'scale') {
                    // Para preguntas de confianza, usar el valor del slider
                    answer = selectedCandidate; // La predicci√≥n del candidato
                    questionConfidence = confidence; // El nivel de confianza
                } else if (qType === 'single_choice' || qType === 'multiple_choice') {
                    // Para selecci√≥n de candidato
                    answer = selectedCandidate;
                }

                return {
                    questionId: qId,
                    answer: answer,
                    confidence: questionConfidence
                };
            });

            const payload = { responses };

            console.log('üì¶ [LANDING] Payload completo:', JSON.stringify(payload, null, 2));

            try {
                const response = await fetch(`${API_URL}/api/surveys/${activeSurveyId}/response`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                });

                console.log('üì° [LANDING] Respuesta HTTP:', response.status, response.statusText);

                if (!response.ok) {
                    const errorData = await response.json();
                    console.error('‚ùå [LANDING] Error del servidor:', errorData);
                    throw new Error(errorData.error || `HTTP ${response.status}`);
                }

                const data = await response.json();
                console.log('‚úÖ [LANDING] Voto sincronizado exitosamente:', data);

                alert('‚úÖ ¬°Predicci√≥n enviada con √©xito!\n\nTu voto ha sido procesado de forma an√≥nima.\nRevisa los resultados en tiempo real abajo. üëá');

                // Resetear formulario
                document.querySelectorAll('.candidate-card').forEach(card => {
                    card.classList.remove('selected');
                });
                document.getElementById('confidence-section').classList.add('hidden');
                selectedCandidate = null;

                // Actualizar resultados
                updateResults();

                // Scroll a resultados
                document.getElementById('results').scrollIntoView({ behavior: 'smooth' });

            } catch (error) {
                console.error('‚ùå [LANDING] Error enviando predicci√≥n:', error.message);
                alert('‚ö†Ô∏è Error al enviar la predicci√≥n:\n\n' + error.message + '\n\nPor favor intenta nuevamente.');
            } finally {
                // Restaurar bot√≥n
                submitButton.disabled = false;
                submitButton.innerHTML = originalText;
            }

            console.log('‚úÖ [LANDING] Proceso completado');
        }

        // ========================================
        // ACTUALIZAR RESULTADOS
        // ========================================
        function updateResults() {
            console.log('üìä [LANDING] Actualizando resultados desde backend...');

            // Por ahora, simulamos resultados locales
            // En producci√≥n, esto deber√≠a cargar desde el API
            if (!votes[selectedCandidate]) {
                votes[selectedCandidate] = { count: 0, confidence: 0 };
            }
            votes[selectedCandidate].count++;
            votes[selectedCandidate].confidence += confidence;

            const container = document.getElementById('results-container');
            const totalVotes = Object.values(votes).reduce((sum, v) => sum + v.count, 0);

            document.getElementById('total-votes').textContent = totalVotes.toLocaleString();

            if (totalVotes === 0) {
                container.innerHTML = `
                    <div class="text-center py-12 bg-gray-50 rounded-lg">
                        <p class="text-gray-500">A√∫n no hay predicciones. ¬°S√© el primero en participar!</p>
                    </div>
                `;
                return;
            }

            const sortedCandidates = Object.entries(votes).sort((a, b) => b[1].count - a[1].count);

            const names = {
                'felix-salgado': 'F√©lix Salgado Macedonio',
                'beatriz-mojica': 'Beatriz Mojica Morga',
                'abelina-lopez': 'Abelina L√≥pez Rodr√≠guez',
                'esthela-damian': 'Esthela Dami√°n Peralta',
                'manuel-anorve': 'Manuel A√±orve Ba√±os',
                'karen-castrejon': 'Karen Castrej√≥n Trujillo',
                'eloy-salmeron': 'Eloy Salmer√≥n D√≠az',
                'julian-lopez': 'Juli√°n L√≥pez Galeana',
                'pedro-segura': 'Pedro Segura Valladares'
            };

            container.innerHTML = sortedCandidates.map(([id, data], index) => {
                const percentage = (data.count / totalVotes * 100).toFixed(1);
                const avgConfidence = (data.confidence / data.count).toFixed(0);

                let medalIcon = '';
                if (index === 0) medalIcon = 'ü•á';
                else if (index === 1) medalIcon = 'ü•à';
                else if (index === 2) medalIcon = 'ü•â';

                return `
                    <div class="bg-white rounded-xl p-6 shadow-lg hover:shadow-xl transition-shadow duration-300">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="font-bold text-lg text-gray-800 flex items-center gap-2">
                                ${medalIcon}
                                <span>${names[id]}</span>
                            </h4>
                            <div class="text-right">
                                <div class="text-2xl font-bold text-gold">${percentage}%</div>
                                <div class="text-sm text-gray-500">${data.count} voto${data.count !== 1 ? 's' : ''}</div>
                            </div>
                        </div>
                        <div class="bg-gray-200 rounded-full h-4 mb-2 overflow-hidden">
                            <div class="progress-bar bg-gradient-to-r from-gold to-yellow-500 h-4 rounded-full transition-all duration-1000" style="width: ${percentage}%"></div>
                        </div>
                        <div class="text-sm text-gray-600">
                            Confianza promedio: <span class="font-semibold text-blue-600">${avgConfidence}%</span>
                        </div>
                    </div>
                `;
            }).join('');

            console.log('üìä [LANDING] Resultados locales actualizados. Total votos:', totalVotes);
        }

        // ========================================
        // UTILIDADES
        // ========================================
        function toggleFAQ(num) {
            const content = document.getElementById(`faq-content-${num}`);
            const icon = document.getElementById(`faq-icon-${num}`);

            content.classList.toggle('hidden');
            icon.classList.toggle('rotate-180');
        }

        // ========================================
        // ANIMACI√ìN CONTADOR DE PARTICIPANTES
        // ========================================
        let participants = 0;
        setInterval(() => {
            participants += Math.floor(Math.random() * 5) + 1;
            document.getElementById('live-participants').textContent = participants.toLocaleString();
        }, 3000);

        // ========================================
        // INICIALIZACI√ìN
        // ========================================
        console.log('üîß [LANDING] Configurando datos iniciales...');

        // Datos de ejemplo para demostraci√≥n
        votes = {
            'beatriz-mojica': { count: 45, confidence: 3200 },
            'felix-salgado': { count: 38, confidence: 2850 },
            'manuel-anorve': { count: 32, confidence: 2400 },
            'abelina-lopez': { count: 28, confidence: 2100 },
            'karen-castrejon': { count: 15, confidence: 1125 }
        };

        updateResults();
        console.log('‚úÖ [LANDING] Datos iniciales cargados');

        // Cargar encuestas al iniciar
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                console.log('üöÄ [LANDING] DOM cargado, inicializando...');
                loadActiveSurveys();
            });
        } else {
            console.log('üöÄ [LANDING] DOM ya est√° listo, inicializando...');
            loadActiveSurveys();
        }

        // Recargar encuestas cada 30 segundos
        setInterval(() => {
            console.log('üîÑ [LANDING] Sincronizaci√≥n autom√°tica de encuestas...');
            loadActiveSurveys();
        }, 30000);

        console.log('‚úÖ [LANDING] Aplicaci√≥n completamente inicializada');
    </script>
</body>
</html>
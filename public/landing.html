<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guerrero Guardianes 2027 | El Vig√≠a de la Democracia</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        body { font-family: 'Outfit', sans-serif; scroll-behavior: smooth; }
        .glass-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .hero-gradient {
            background: linear-gradient(135deg, #0F172A 0%, #1E293B 100%);
        }
        .security-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 25px;
            height: 25px;
            background: #4F46E5;
            cursor: pointer;
            border-radius: 50%;
            border: 4px solid white;
            box-shadow: 0 0 10px rgba(0,0,0,0.2);
        }
        .step-card:hover { transform: translateY(-5px); }
    </style>
</head>
<body class="bg-slate-50 text-slate-900">

    <!-- Navbar -->
    <nav class="fixed w-full z-50 transition-all duration-300 bg-white/90 backdrop-blur-md shadow-sm" id="navbar">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-20 items-center">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-indigo-600 rounded-lg flex items-center justify-center text-white font-bold text-xl">G</div>
                    <span class="text-xl font-bold text-slate-800 tracking-tight">Guardianes<span class="text-indigo-600">2027</span></span>
                </div>
                <div class="hidden md:flex space-x-8">
                    <a href="#proceso" class="text-slate-600 hover:text-indigo-600 font-medium transition">C√≥mo Funciona</a>
                    <a href="#seguridad" class="text-slate-600 hover:text-indigo-600 font-medium transition">Seguridad</a>
                    <a href="#impacto" class="text-slate-600 hover:text-indigo-600 font-medium transition">Impacto</a>
                </div>
                <button onclick="openLoginModal()" class="px-6 py-2.5 bg-indigo-600 text-white rounded-full font-semibold hover:bg-indigo-700 transition shadow-lg shadow-indigo-200">
                    Acceso Ciudadano
                </button>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="min-h-screen pt-20 flex items-center hero-gradient relative overflow-hidden">
        <div class="absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]"></div>
        
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10 w-full">
            <div class="grid lg:grid-cols-2 gap-12 items-center">
                <div class="space-y-8 animate-fade-in-up">
                    <div class="inline-flex items-center px-4 py-2 rounded-full bg-slate-800 border border-slate-700 text-indigo-400 text-sm font-medium mb-4">
                        <span class="w-2 h-2 bg-green-500 rounded-full mr-2 animate-pulse"></span>
                        Sistema de Alta Disponibilidad Activo
                    </div>
                    <h1 class="text-5xl lg:text-7xl font-bold text-white leading-tight">
                        El Vig√≠a del Faro de la <span class="text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-cyan-400">Democracia</span>
                    </h1>
                    <p class="text-xl text-slate-300 max-w-lg leading-relaxed">
                        Plataforma independiente que valida la voluntad ciudadana en Guerrero con tecnolog√≠a inhackeable. Tu voz cuenta y se protege.
                    </p>
                    <div class="flex flex-col sm:flex-row gap-4 pt-4">
                        <button onclick="scrollToSection('proceso')" class="px-8 py-4 bg-white text-slate-900 rounded-xl font-bold hover:bg-slate-100 transition shadow-xl text-lg">
                            Ver C√≥mo Funciona
                        </button>
                        <button onclick="openLoginModal()" class="px-8 py-4 bg-transparent border border-slate-600 text-white rounded-xl font-bold hover:bg-slate-800 transition text-lg backdrop-blur-sm">
                            Participar Ahora
                        </button>
                    </div>
                    
                    <!-- Stats Mini -->
                    <div class="grid grid-cols-3 gap-6 pt-8 border-t border-slate-700/50">
                        <div>
                            <div class="text-3xl font-bold text-white">100%</div>
                            <div class="text-sm text-slate-400">An√≥nimo</div>
                        </div>
                        <div>
                            <div class="text-3xl font-bold text-white">24/7</div>
                            <div class="text-sm text-slate-400">Monitoreo</div>
                        </div>
                        <div>
                            <div class="text-3xl font-bold text-white">IEPC</div>
                            <div class="text-sm text-slate-400">Validado</div>
                        </div>
                    </div>
                </div>

                <div class="relative lg:h-[600px] flex items-center justify-center">
                    <!-- Interactive Visual -->
                    <div class="relative w-full max-w-md aspect-square bg-gradient-to-tr from-indigo-500/20 to-purple-500/20 rounded-full blur-3xl absolute"></div>
                    <div class="glass-panel p-8 rounded-3xl shadow-2xl border-t border-white/10 w-full max-w-md relative animate-float">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-lg font-semibold text-slate-800">Tendencia en Vivo</h3>
                            <span class="text-xs font-mono text-green-600 bg-green-100 px-2 py-1 rounded">‚óè LIVE</span>
                        </div>
                        <canvas id="heroChart" height="250"></canvas>
                        <div class="mt-6 space-y-3">
                            <div class="flex items-center justify-between text-sm">
                                <span class="text-slate-600">Participaci√≥n</span>
                                <span class="font-bold text-slate-900">1,245 votantes</span>
                            </div>
                            <div class="w-full bg-slate-200 rounded-full h-2">
                                <div class="bg-indigo-600 h-2 rounded-full" style="width: 65%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- C√≥mo Funciona (4 Pasos) -->
    <section id="proceso" class="py-24 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-4xl font-bold text-slate-900 mb-4">Proceso de Validaci√≥n</h2>
                <p class="text-slate-600 max-w-2xl mx-auto">Cuatro pasos simples para garantizar que tu opini√≥n se convierta en data inmutable.</p>
            </div>

            <div class="grid md:grid-cols-4 gap-8">
                <!-- Paso 1 -->
                <div class="step-card p-8 rounded-2xl bg-slate-50 border border-slate-100 transition-all duration-300 group hover:shadow-xl hover:border-indigo-100">
                    <div class="w-14 h-14 bg-indigo-100 rounded-xl flex items-center justify-center text-indigo-600 mb-6 group-hover:scale-110 transition-transform">
                        <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"></path></svg>
                    </div>
                    <h3 class="text-xl font-bold text-slate-900 mb-3">1. Acceso Seguro</h3>
                    <p class="text-slate-600 text-sm leading-relaxed">Ingresa tu n√∫mero. Generamos un hash criptogr√°fico √∫nico. Tu n√∫mero real <span class="font-bold text-indigo-600">NUNCA</span> se almacena.</p>
                </div>

                <!-- Paso 2 -->
                <div class="step-card p-8 rounded-2xl bg-slate-50 border border-slate-100 transition-all duration-300 group hover:shadow-xl hover:border-indigo-100">
                    <div class="w-14 h-14 bg-indigo-100 rounded-xl flex items-center justify-center text-indigo-600 mb-6 group-hover:scale-110 transition-transform">
                        <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    </div>
                    <h3 class="text-xl font-bold text-slate-900 mb-3">2. Verificaci√≥n</h3>
                    <p class="text-slate-600 text-sm leading-relaxed">Recibes un c√≥digo SMS instant√°neo. Esto valida que eres un ciudadano real sin pedir INE ni datos personales.</p>
                </div>

                <!-- Paso 3 -->
                <div class="step-card p-8 rounded-2xl bg-slate-50 border border-slate-100 transition-all duration-300 group hover:shadow-xl hover:border-indigo-100">
                    <div class="w-14 h-14 bg-indigo-100 rounded-xl flex items-center justify-center text-indigo-600 mb-6 group-hover:scale-110 transition-transform">
                        <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg>
                    </div>
                    <h3 class="text-xl font-bold text-slate-900 mb-3">3. Participaci√≥n</h3>
                    <p class="text-slate-600 text-sm leading-relaxed">Responde encuestas oficiales o reporta incidentes en tu zona. Gana puntos por contribuir a la democracia.</p>
                </div>

                <!-- Paso 4 -->
                <div class="step-card p-8 rounded-2xl bg-slate-50 border border-slate-100 transition-all duration-300 group hover:shadow-xl hover:border-indigo-100">
                    <div class="w-14 h-14 bg-indigo-100 rounded-xl flex items-center justify-center text-indigo-600 mb-6 group-hover:scale-110 transition-transform">
                        <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path></svg>
                    </div>
                    <h3 class="text-xl font-bold text-slate-900 mb-3">4. Transparencia</h3>
                    <p class="text-slate-600 text-sm leading-relaxed">Los resultados se publican en tiempo real en el Dashboard p√∫blico. Inalterable y verificable por todos.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Slider de Seguridad -->
    <section id="seguridad" class="py-24 bg-slate-900 text-white relative overflow-hidden">
        <div class="absolute inset-0 bg-gradient-to-b from-indigo-900/20 to-slate-900/90"></div>
        <div class="max-w-4xl mx-auto px-4 relative z-10 text-center">
            <h2 class="text-3xl font-bold mb-12">Niveles de Integridad</h2>
            
            <div class="mb-16">
                <input type="range" min="0" max="100" value="50" class="security-slider w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer" id="securitySlider">
                <div class="flex justify-between mt-4 text-xs font-mono text-slate-400 uppercase tracking-widest">
                    <span>M√≠nimo</span>
                    <span class="text-indigo-400 font-bold">Est√°ndar Actual</span>
                    <span>M√°ximo</span>
                </div>
            </div>

            <div id="securityContent" class="transition-all duration-500 transform">
                <!-- Content handled by JS -->
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-slate-950 text-slate-400 py-12 border-t border-slate-800">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <div class="flex items-center justify-center space-x-2 mb-8">
                <div class="w-8 h-8 bg-indigo-600/20 rounded flex items-center justify-center text-indigo-500 font-bold">G</div>
                <span class="text-lg font-bold text-white">Guardianes 2027</span>
            </div>
            <p class="text-sm mb-8">Developed by Antigravity for Guerrero high-availability election monitoring.</p>
            <div class="flex justify-center space-x-6 text-sm">
                <a href="#" class="hover:text-white transition">Privacidad</a>
                <a href="#" class="hover:text-white transition">T√©rminos</a>
                <a href="/admin" class="hover:text-white transition">Admin Portal</a>
            </div>
        </div>
    </footer>

    <!-- Login Modal -->
    <div id="loginModal" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm" onclick="closeLoginModal()"></div>
        <div class="absolute inset-0 flex items-center justify-center p-4">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md p-8 relative transform transition-all scale-95" id="loginCard">
                <button onclick="closeLoginModal()" class="absolute top-4 right-4 text-slate-400 hover:text-slate-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
                
                <h3 class="text-2xl font-bold text-slate-900 mb-2">Bienvenido Ciudadano</h3>
                <p class="text-slate-500 mb-6">Ingresa tu n√∫mero para acceder. Sin registro previo.</p>
                
                <form id="authForm" onsubmit="handleAuth(event)">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-slate-700 mb-1">N√∫mero Celular</label>
                            <div class="relative">
                                <span class="absolute left-3 top-3 text-slate-400 font-medium">+52</span>
                                <input type="tel" id="phone" maxlength="10" class="w-full pl-12 pr-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition" placeholder="744 123 4567" required>
                            </div>
                        </div>
                        
                        <div id="codeSection" class="hidden animate-fade-in">
                            <label class="block text-sm font-medium text-slate-700 mb-1">C√≥digo de Verificaci√≥n</label>
                            <input type="text" id="code" maxlength="4" class="w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-indigo-500 text-center font-mono text-lg tracking-widest" placeholder="0 0 0 0">
                            <p class="text-xs text-indigo-600 mt-2 text-center">C√≥digo enviado (Simulado: 1234)</p>
                        </div>

                        <button type="submit" id="authBtn" class="w-full bg-indigo-600 text-white font-bold py-3 rounded-xl hover:bg-indigo-700 transition shadow-lg shadow-indigo-100 flex justify-center items-center">
                            <span>Solicitar C√≥digo</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Hero Chart
        const ctx = document.getElementById('heroChart').getContext('2d');
        new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: ['Morena', 'PRI-PAN-PRD', 'MC', 'Independientes'],
                datasets: [{
                    data: [45, 30, 15, 10],
                    backgroundColor: ['#B91C1C', '#1D4ED8', '#F97316', '#64748B'],
                    borderWidth: 0,
                    hoverOffset: 10
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                cutout: '70%',
                plugins: { legend: { display: false } }
            }
        });

        // Interactive Security Slider Logic
        const slider = document.getElementById('securitySlider');
        const content = document.getElementById('securityContent');
        const stages = [
            {
                val: 0,
                title: "Encuestadora Tradicional",
                desc: "Datos opacos, metodolog√≠a cerrada, susceptibles a manipulaci√≥n.",
                icon: "‚ùå"
            },
            {
                val: 50,
                title: "Guerrero Guardianes (Est√°ndar)",
                desc: "Hash an√≥nimo, IP no almacenada, protecci√≥n SSL/TLS est√°ndar.",
                icon: "üõ°Ô∏è"
            },
            {
                val: 100,
                title: "M√°xima Integridad (Misi√≥n 2027)",
                desc: "Verificaci√≥n SMS de 2 pasos, Audit Trail inmutable, Monitoreo de Amenazas 24/7.",
                icon: "üîí"
            }
        ];

        function updateSlider() {
            let val = parseInt(slider.value);
            let stage = stages[0];
            if(val > 33 && val < 66) stage = stages[1];
            if(val >= 66) stage = stages[2];

            content.innerHTML = `
                <div class="glass-panel p-8 rounded-2xl max-w-lg mx-auto border border-indigo-500/30 shadow-[0_0_50px_rgba(79,70,229,0.2)]">
                    <div class="text-6xl mb-4 animate-bounce">${stage.icon}</div>
                    <h3 class="text-2xl font-bold text-white mb-2">${stage.title}</h3>
                    <p class="text-indigo-200">${stage.desc}</p>
                </div>
            `;
        }

        slider.addEventListener('input', updateSlider);
        updateSlider(); // Init

        // Auth Logic
        let step = 'phone';
        
        function openLoginModal() {
            document.getElementById('loginModal').classList.remove('hidden');
        }

        function closeLoginModal() {
            document.getElementById('loginModal').classList.add('hidden');
        }

        async function handleAuth(e) {
            e.preventDefault();
            const btn = document.getElementById('authBtn');
            const phoneInput = document.getElementById('phone');
            const codeInput = document.getElementById('code');

            if (step === 'phone') {
                const phone = phoneInput.value.replace(/\D/g, '');
                if (phone.length !== 10) {
                    Swal.fire('Error', 'Ingresa un n√∫mero de 10 d√≠gitos', 'error');
                    return;
                }

                btn.innerHTML = '<span class="animate-spin mr-2">‚Üª</span> Enviando...';
                
                try {
                    const res = await fetch('/api/auth/request-code', {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({ phone })
                    });
                    const data = await res.json();
                    
                    if (data.success) {
                        step = 'code';
                        document.getElementById('codeSection').classList.remove('hidden');
                        phoneInput.disabled = true;
                        btn.innerText = 'Verificar y Entrar';
                        // Auto-fill mock code for demo
                        if(data.code) codeInput.value = data.code;
                    } else {
                        Swal.fire('Error', data.error, 'error');
                    }
                } catch (err) {
                    Swal.fire('Error', 'Error de conexi√≥n', 'error');
                } finally {
                    if (step === 'phone') btn.innerText = 'Solicitar C√≥digo';
                }

            } else {
                const phone = phoneInput.value.replace(/\D/g, '');
                const code = codeInput.value;

                btn.innerHTML = '<span class="animate-spin mr-2">‚Üª</span> Verificando...';

                try {
                    const res = await fetch('/api/auth/verify-code', {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({ phone, code })
                    });
                    const data = await res.json();

                    if (data.success) {
                        localStorage.setItem('token', data.token);
                        localStorage.setItem('user', JSON.stringify(data.user));
                        window.location.href = '/portal';
                    } else {
                        Swal.fire('Error', data.error, 'error');
                        btn.innerText = 'Verificar y Entrar';
                    }
                } catch (err) {
                    btn.innerText = 'Verificar y Entrar';
                    Swal.fire('Error', 'Error de conexi√≥n', 'error');
                }
            }
        }

        function scrollToSection(id) {
            document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>
</html>